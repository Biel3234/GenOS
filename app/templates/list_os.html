{% extends 'base.html' %}
{% block title %}Ordens - GenOS{% endblock %}

{% block content %}
<div class="card">
    <div class="list-header">
        <h2>Ordens de Serviço</h2>
        <form method="get" action="" class="search-form" role="search">
            <label for="search-q" class="sr-only">Pesquisar</label>
            <input id="search-q" type="search" name="q" placeholder="Pesquisar ordens..." value="{{ request.GET.q }}" class="search-input">
            <button type="submit" class="btn outline search-btn" aria-label="Buscar">
                <!-- lupa SVG compacta -->
                <svg class="icon-search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <circle cx="11" cy="11" r="7"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </button>
        </form>
    </div>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Cliente / Moto</th>
                <th>Data</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
        {% for os in ordens %}
            <tr>
                <td>{{ os.id }}</td>
                <td>{{ os.cliente }} / {{ os.moto }}</td>
                <td class="small">{{ os.data }}</td>
                <td class="actions-row">
                    <a class="btn" href="{% url 'baixar_pdf' os.id %}" target="_blank">PDF</a>
                    <a class="btn outline" href="{% url 'detalhar' os.id %}">Ver</a>
                    <a class="btn danger" href="{% url 'deletar' os.id %}">Deletar</a>
                </td>
            </tr>
        {% empty %}
            <tr><td colspan="4">Nenhuma ordem encontrada.</td></tr>
        {% endfor %}
        </tbody>
    </table>
    {% if is_paginated %}
    <div class="pagination-wrapper">
        <nav class="pagination" aria-label="Paginação de ordens">
            {% if page_obj.has_previous %}
                <a class="btn outline" href="?page={{ page_obj.previous_page_number }}">&laquo; Anterior</a>
            {% else %}
                <span class="btn outline" aria-disabled="true">&laquo; Anterior</span>
            {% endif %}

            <div class="page-numbers">
                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                        <span class="btn active">{{ num }}</span>
                    {% else %}
                        <a class="btn" href="?page={{ num }}">{{ num }}</a>
                    {% endif %}
                {% endfor %}
            </div>

            {% if page_obj.has_next %}
                <a class="btn outline" href="?page={{ page_obj.next_page_number }}">Próxima &raquo;</a>
            {% else %}
                <span class="btn outline" aria-disabled="true">Próxima &raquo;</span>
            {% endif %}
        </nav>
    </div>
    {% endif %}
</div>
{% endblock %}